<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Space Engineers: Sources/Sandbox.Game/Game/Replication/MyStreamingEntityStateGroup.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Space Engineers
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_937900b87e0c7a5fa01190c395fb83f7.html">Sources</a></li><li class="navelem"><a class="el" href="dir_adcb7f0194fb5944415bcd7197787778.html">Sandbox.Game</a></li><li class="navelem"><a class="el" href="dir_04f95e6316a1b10de98d9c990257507d.html">Game</a></li><li class="navelem"><a class="el" href="dir_08026fe84744742d5ec863a33bb0b13b.html">Replication</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MyStreamingEntityStateGroup.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_my_streaming_entity_state_group_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_sandbox.html">Sandbox</a>.<a class="code" href="namespace_sandbox_1_1_engine.html">Engine</a>.<a class="code" href="namespace_sandbox_1_1_engine_1_1_utils.html">Utils</a>;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_sandbox.html">Sandbox</a>.<a class="code" href="namespace_sandbox_1_1_game.html">Game</a>.<a class="code" href="namespace_sandbox_1_1_game_1_1_entities.html">Entities</a>;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> <a class="code" href="_my_gui_skin_definition_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a>;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_collections.html">Collections</a>.<a class="code" href="namespace_system_1_1_collections_1_1_generic.html">Generic</a>;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Diagnostics;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_i_o.html">IO</a>;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_i_o.html">IO</a>.Compression;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_linq.html">Linq</a>;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_text.html">Text</a>;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_utils.html">Utils</a>;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_network.html">Network</a>;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_utils.html">Utils</a>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_sandbox.html">Sandbox</a>.<a class="code" href="namespace_v_rage_1_1_game.html#ae840d3864e36153d6f5013c7a0403dcf">Game</a>.<a class="code" href="namespace_v_rage_1_1_network.html#adac6df3dba000e71924ba5bd2286cd76a8c340dc334134096f68b880b42a8692c">Replication</a></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keyword">class </span>MemoryCompressor</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> CopyTo(Stream src, Stream dest)</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;            byte[] bytes = <span class="keyword">new</span> byte[4096];</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            <span class="keywordtype">int</span> cnt;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            <span class="keywordflow">while</span> ((cnt = src.Read(bytes, 0, bytes.Length)) != 0)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                dest.Write(bytes, 0, cnt);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> byte[] Compress(byte[] bytes)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="keyword">using</span> (var msi = <span class="keyword">new</span> MemoryStream(bytes))</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keyword">using</span> (var mso = <span class="keyword">new</span> MemoryStream())</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                <span class="keyword">using</span> (var gs = <span class="keyword">new</span> GZipStream(mso, CompressionMode.Compress))</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                    <span class="comment">//msi.CopyTo(gs);</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    CopyTo(msi, gs);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                <span class="keywordflow">return</span> mso.ToArray();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> byte[] Decompress(byte[] bytes)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keyword">using</span> (var msi = <span class="keyword">new</span> MemoryStream(bytes))</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keyword">using</span> (var mso = <span class="keyword">new</span> MemoryStream())</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                <span class="keyword">using</span> (var gs = <span class="keyword">new</span> GZipStream(msi, CompressionMode.Decompress))</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                    <span class="comment">//gs.CopyTo(mso);</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                    CopyTo(gs, mso);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <span class="keywordflow">return</span> mso.ToArray();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html">   59</a></span>&#160;    <span class="keyword">class </span><a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html">MyStreamingEntityStateGroup</a>&lt;T&gt; : <a class="code" href="interface_v_rage_1_1_network_1_1_i_my_state_group.html">IMyStateGroup</a> where T : <a class="code" href="interface_v_rage_1_1_network_1_1_i_my_streamable_replicable.html">IMyStreamableReplicable</a></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">int</span> m_streamSize = 8000;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> HEADER_SIZE = 97;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> SAFE_VALUE = 128;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ab5166f90783361307ffe2be7bfde77e6">   65</a></span>&#160;        <span class="keyword">public</span> T Instance { <span class="keyword">get</span>; <span class="keyword">private</span> set; }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">bool</span> m_streamed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ac4d4a13260701b3fb4ff2a55b780defb">   69</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ac4d4a13260701b3fb4ff2a55b780defb">MyStreamingEntityStateGroup</a>(T obj)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            Instance = obj;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keyword">class </span>StreamPartInfo : IComparable&lt;StreamPartInfo&gt;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">int</span> StartIndex;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">int</span> NumBits;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">short</span> Position;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">int</span> CompareTo(StreamPartInfo b)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="keywordflow">return</span> this.StartIndex.CompareTo(b.StartIndex);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keyword">class </span>StreamClientData</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">short</span> CurrentPart;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">short</span> NumParts;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">int</span> LastPosition;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keyword">public</span> byte[] ObjectData;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">bool</span> Dirty;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">int</span> RemainingBits;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">int</span> UncompressedSize;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">bool</span> ForceSend = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keyword">public</span> Dictionary&lt;byte, StreamPartInfo&gt; SendPackets = <span class="keyword">new</span> Dictionary&lt;byte, StreamPartInfo&gt;();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keyword">public</span> List&lt;StreamPartInfo&gt; FailedIncompletePackets = <span class="keyword">new</span> List&lt;StreamPartInfo&gt;();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        Dictionary&lt;ulong, StreamClientData&gt; m_clientStreamData;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        SortedList&lt;StreamPartInfo, byte[]&gt; m_recivedParts;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">short</span> m_numPartsToRecive = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">int</span> m_recievedBytes = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">int</span> m_uncompressedSize = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_v_rage_1_1_network.html#afd0c0e2c33a4c1987d62c47d4bd7ffa1">StateGroupEnum</a> GroupType</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ab1af4344a555491452ed45c8bc868171">  111</a></span>&#160;        {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keyword">get</span> { <span class="keywordflow">return</span> <a class="code" href="namespace_v_rage_1_1_network.html#afd0c0e2c33a4c1987d62c47d4bd7ffa1">StateGroupEnum</a>.Streamining; }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a49f1433ce94a056a2462618d9df838be">  115</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a49f1433ce94a056a2462618d9df838be">CreateClientData</a>(<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html">MyClientStateBase</a> forClient)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">if</span> (m_clientStreamData == null)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                m_clientStreamData = <span class="keyword">new</span> Dictionary&lt;ulong, StreamClientData&gt;();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            StreamClientData data;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">if</span> (m_clientStreamData.TryGetValue(forClient.<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html#acf0bf51dce3efe39b3c9635d26120ea0">EndpointId</a>.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>, out data) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                m_clientStreamData[forClient.<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html#acf0bf51dce3efe39b3c9635d26120ea0">EndpointId</a>.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>] = <span class="keyword">new</span> StreamClientData();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            m_clientStreamData[forClient.<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html#acf0bf51dce3efe39b3c9635d26120ea0">EndpointId</a>.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>].Dirty = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ad755c81fbc0fc1be185a40cdd6fc5381">  130</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ad755c81fbc0fc1be185a40cdd6fc5381">DestroyClientData</a>(<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html">MyClientStateBase</a> forClient)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">if</span> (m_clientStreamData != null)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                m_clientStreamData.Remove(forClient.<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html#acf0bf51dce3efe39b3c9635d26120ea0">EndpointId</a>.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a09b345568e8b77b1d39b905de4fd7ca6">  138</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a09b345568e8b77b1d39b905de4fd7ca6">ClientUpdate</a>(uint timestamp)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ada0e8bc2839ea6ff0ff873e0cea0d7a7">  143</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ada0e8bc2839ea6ff0ff873e0cea0d7a7">Destroy</a>()</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> (m_recivedParts != null)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                m_recivedParts.Clear();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                m_recivedParts = null;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a60abf1237a1d63f9eafc191ad1e0d90c">  152</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">float</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a60abf1237a1d63f9eafc191ad1e0d90c">GetGroupPriority</a>(<span class="keywordtype">int</span> frameCountWithoutSync, <a class="code" href="struct_v_rage_1_1_network_1_1_my_client_info.html">MyClientInfo</a> forClient)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            StreamClientData clientData = m_clientStreamData[forClient.<a class="code" href="struct_v_rage_1_1_network_1_1_my_client_info.html#a834351798d201ff41e34d2baf1e6fd6e">EndpointId</a>.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>];</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">if</span>(forClient.<a class="code" href="struct_v_rage_1_1_network_1_1_my_client_info.html#a1d5f48a00a73aa03af2bb7e0ae84bf4b">IsReplicableReady</a>(Instance as <a class="code" href="interface_v_rage_1_1_network_1_1_i_my_replicable.html">IMyReplicable</a>))</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                clientData.CurrentPart = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                clientData.ForceSend = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                clientData.ObjectData = null;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                clientData.FailedIncompletePackets.Clear();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                clientData.SendPackets.Clear();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordtype">float</span> priority = forClient.<a class="code" href="struct_v_rage_1_1_network_1_1_my_client_info.html#af11d3cae7ed4ffac984125b2aa2af8dd">HasReplicable</a>(Instance as IMyReplicable) &amp;&amp; clientData.Dirty ? Instance.GetPriority(forClient,<span class="keyword">false</span>) * Instance.PriorityScale() : 0.0f;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">if</span> (priority &lt; 0.01f &amp;&amp; (clientData.ForceSend || clientData.FailedIncompletePackets.Count &gt;0))</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                priority = Instance.PriorityScale();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">return</span> priority;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> ReadPart(ref <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> stream)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            m_numPartsToRecive = stream.ReadInt16();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordtype">short</span> currentPacket = stream.ReadInt16();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">int</span> bitsToRecieve = stream.ReadInt32();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordtype">int</span> bytesToRecieve = <a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html">MyLibraryUtils</a>.<a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html#afd4d5ec658b60d4fded0e1018f543680">GetDivisionCeil</a>(bitsToRecieve, 8);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordtype">int</span> numBitsInStream = stream.BitLength - stream.BitPosition;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> (numBitsInStream &lt; bitsToRecieve)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                Debug.Fail(<span class="stringliteral">&quot;trying to read more than there is in stream. Why ?&quot;</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <a class="code" href="class_v_rage_1_1_utils_1_1_my_log.html">MyLog</a>.<a class="code" href="class_v_rage_1_1_utils_1_1_my_log.html#ad6211c26fe6b341fedd7d8fe05eb14fd">Default</a>.<a class="code" href="class_v_rage_1_1_utils_1_1_my_log.html#a280e0f68244c251cc79e8e6862340bf2">WriteLine</a>(<span class="stringliteral">&quot;trying to read more than there is in stream. Total num parts : &quot;</span> + m_numPartsToRecive.ToString() + <span class="stringliteral">&quot; current part : &quot;</span> + currentPacket.ToString() + <span class="stringliteral">&quot; bits to read : &quot;</span> + bitsToRecieve.ToString() + <span class="stringliteral">&quot; bits in stream : &quot;</span> + numBitsInStream.ToString() + <span class="stringliteral">&quot; replicable : &quot;</span> + Instance.ToString());</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;               <span class="comment">//what now ?</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">if</span> (m_recivedParts == null)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                m_recivedParts = <span class="keyword">new</span> SortedList&lt;StreamPartInfo, byte[]&gt;();        </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            m_recievedBytes += bytesToRecieve;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            byte[] partData = <span class="keyword">new</span> byte[bytesToRecieve];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            unsafe</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                fixed (byte* dataPtr = partData)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    stream.ReadMemory(dataPtr, bitsToRecieve);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            StreamPartInfo info = <span class="keyword">new</span> StreamPartInfo();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            info.NumBits = bitsToRecieve;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            info.StartIndex = currentPacket;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            m_recivedParts[info] = partData;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ProcessRead(ref <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> stream)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="comment">//becaouse client state group is unreliable, it can happen, that some acks are not recieved at server</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">//and server sends them again. In streaming this is not good, so we need to drop streaming when we got stream again</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span> (stream.BitLength == stream.BitPosition || m_streamed)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordtype">bool</span> hasData = stream.ReadBool();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> (hasData)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                m_uncompressedSize = stream.ReadInt32();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keywordflow">if</span>(ReadPart(ref stream) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    <span class="comment">//something wrong happened, server send bad data, don&#39;t know what to do,</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="comment">//cancel replicable on server</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    m_recivedParts = null;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    Instance.LoadCancel();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordflow">if</span> (m_recivedParts.Count == m_numPartsToRecive)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    m_streamed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    CreateReplicable(m_uncompressedSize);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <a class="code" href="namespace_sandbox_1_1_game_1_1_gui.html#a85590df7a7e0f84aafc9c190d8b4699eaa603905470e2a5b8c13e96b579ef0dba">Debug</a>.Assert(<span class="keyword">false</span>,<span class="stringliteral">&quot;testing assert to find issue, if you got this and game is running, please ignore it&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <a class="code" href="class_v_rage_1_1_utils_1_1_my_log.html">MyLog</a>.<a class="code" href="class_v_rage_1_1_utils_1_1_my_log.html#ad6211c26fe6b341fedd7d8fe05eb14fd">Default</a>.<a class="code" href="class_v_rage_1_1_utils_1_1_my_log.html#a280e0f68244c251cc79e8e6862340bf2">WriteLine</a>(<span class="stringliteral">&quot;received empty state group&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="comment">//something went wrong we need to cancel this replicable and hope next time it will be ok </span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordflow">if</span> (m_recivedParts != null)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    m_recivedParts.Clear();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                m_recivedParts = null;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                Instance.LoadCancel(); </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateReplicable(<span class="keywordtype">int</span> uncompressedSize)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            byte[] ret = <span class="keyword">new</span> byte[m_recievedBytes];</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">foreach</span> (var part <span class="keywordflow">in</span> m_recivedParts)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <a class="code" href="namespace_buffer.html">Buffer</a>.BlockCopy(part.Value, 0, ret, offset, part.Value.Length);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                offset += part.Value.Length;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            byte[] decompressed = MemoryCompressor.Decompress(ret);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> str = <span class="keyword">new</span> <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a>();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            str.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html#a7d6cf5a969d27c6c35c26867d3f85d6c">ResetWrite</a>();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            unsafe</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                fixed (byte* dataPtr = decompressed)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    str.SerializeMemory(dataPtr, uncompressedSize);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            str.ResetRead();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            Instance.LoadDone(str);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            str.Dispose();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">if</span> (m_recivedParts != null)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                m_recivedParts.Clear();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            m_recivedParts = null;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            m_recievedBytes = 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ProcessWrite(<span class="keywordtype">int</span> maxBitPosition, ref <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> stream, <a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html">EndpointId</a> forClient, byte packetId)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            m_streamSize = <a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html">MyLibraryUtils</a>.<a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html#afd4d5ec658b60d4fded0e1018f543680">GetDivisionCeil</a>(maxBitPosition - stream.BitPosition - HEADER_SIZE - SAFE_VALUE, 8) * 8;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            StreamClientData clientData = m_clientStreamData[forClient.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">if</span> (clientData.FailedIncompletePackets.Count &gt; 0)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                stream.WriteBool(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                WriteIncompletePacket(clientData, packetId, ref stream);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordtype">int</span> bitsToSend = 0;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordtype">bool</span> incomplete = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">if</span> (clientData.ObjectData == null)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            {                </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                SaveReplicable(clientData);               </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                incomplete = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            clientData.NumParts = (short)<a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html">MyLibraryUtils</a>.<a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html#afd4d5ec658b60d4fded0e1018f543680">GetDivisionCeil</a>(clientData.ObjectData.Length * 8, m_streamSize);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            bitsToSend = clientData.RemainingBits;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">if</span> (bitsToSend == 0)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                clientData.ForceSend = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                clientData.Dirty = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                stream.WriteBool(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            stream.WriteBool(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            stream.WriteInt32(clientData.UncompressedSize);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">if</span> (bitsToSend &gt; m_streamSize || incomplete)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                WritePart(ref bitsToSend, clientData, packetId, ref stream);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                WriteWhole(bitsToSend, clientData, packetId, ref stream);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordflow">if</span> (clientData.RemainingBits == 0)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                clientData.Dirty = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                clientData.ForceSend = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> WriteIncompletePacket(StreamClientData clientData, byte packetId, ref <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> stream)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">if</span>(clientData.ObjectData == null)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                clientData.FailedIncompletePackets.Clear();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            StreamPartInfo failedPart = clientData.FailedIncompletePackets[0];</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            clientData.FailedIncompletePackets.Remove(failedPart);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            clientData.SendPackets[packetId] = failedPart;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            stream.WriteInt32(clientData.UncompressedSize);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            stream.WriteInt16(clientData.NumParts);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            stream.WriteInt16(failedPart.Position);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            stream.WriteInt32(failedPart.NumBits);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;         </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            unsafe</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                fixed (byte* dataPtr = &amp;clientData.ObjectData[failedPart.StartIndex])</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    stream.WriteMemory(dataPtr, failedPart.NumBits);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> WritePart(ref <span class="keywordtype">int</span> bitsToSend, StreamClientData clientData, byte packetId, ref <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> stream)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            bitsToSend = <a class="code" href="namespace_math.html">Math</a>.Min(m_streamSize, clientData.RemainingBits);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            StreamPartInfo info = <span class="keyword">new</span> StreamPartInfo();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            info.StartIndex = clientData.LastPosition;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            info.NumBits = bitsToSend;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            clientData.LastPosition = info.StartIndex + <a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html">MyLibraryUtils</a>.<a class="code" href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html#afd4d5ec658b60d4fded0e1018f543680">GetDivisionCeil</a>(m_streamSize, 8);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            clientData.SendPackets[packetId] = info;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            clientData.RemainingBits = <a class="code" href="namespace_math.html">Math</a>.Max(0, clientData.RemainingBits - m_streamSize);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            stream.WriteInt16(clientData.NumParts);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            stream.WriteInt16(clientData.CurrentPart);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            info.Position = clientData.CurrentPart;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            clientData.CurrentPart++;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            stream.WriteInt32(bitsToSend);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            unsafe</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                fixed (byte* dataPtr = &amp;clientData.ObjectData[info.StartIndex])</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    stream.WriteMemory(dataPtr, bitsToSend);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> WriteWhole(<span class="keywordtype">int</span> bitsToSend, StreamClientData clientData, byte packetId, ref <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> stream)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            StreamPartInfo info = <span class="keyword">new</span> StreamPartInfo();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            info.StartIndex = 0;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            info.NumBits = bitsToSend;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            info.Position = 0;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            clientData.SendPackets[packetId] = info;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            clientData.RemainingBits = 0;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            clientData.Dirty = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            clientData.ForceSend = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            stream.WriteInt16(1);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            stream.WriteInt16(0);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            stream.WriteInt32(bitsToSend);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            unsafe</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                fixed (byte* dataPtr = clientData.ObjectData)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    stream.WriteMemory(dataPtr, bitsToSend);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a7e7f84a5b9a9de3476460bb9d00c1875">  429</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a7e7f84a5b9a9de3476460bb9d00c1875">Serialize</a>(<a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> stream, <a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html">EndpointId</a> forClient, uint timestamp, byte packetId, <span class="keywordtype">int</span> maxBitPosition)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">if</span> (stream.Reading)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                ProcessRead(ref stream);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                ProcessWrite(maxBitPosition, ref stream, forClient, packetId);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> SaveReplicable(StreamClientData clientData)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a> str = <span class="keyword">new</span> <a class="code" href="namespace_v_rage.html">VRage</a>.<a class="code" href="namespace_v_rage_1_1_library.html">Library</a>.<a class="code" href="namespace_v_rage_1_1_library_1_1_collections.html">Collections</a>.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">BitStream</a>();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            str.<a class="code" href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html#a7d6cf5a969d27c6c35c26867d3f85d6c">ResetWrite</a>();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            Instance.Serialize(str);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            str.ResetRead();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordtype">int</span> numObjectBits = str.BitLength;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            byte[] uncompressedData = <span class="keyword">new</span> byte[str.ByteLength];</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            unsafe</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                fixed (byte* dataPtr = uncompressedData)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    str.SerializeMemory(dataPtr, numObjectBits);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            str.Dispose();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            clientData.CurrentPart = 0;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            clientData.ObjectData = MemoryCompressor.Compress(uncompressedData);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            clientData.UncompressedSize = numObjectBits;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            clientData.RemainingBits = clientData.ObjectData.Length * 8;           </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a92fa83cbfe1400a64a1da015ac81773a">  468</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a92fa83cbfe1400a64a1da015ac81773a">OnAck</a>(<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html">MyClientStateBase</a> forClient, byte packetId, <span class="keywordtype">bool</span> delivered)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="comment">//streaming  is reliable don&#39;t care</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            StreamClientData clientData = m_clientStreamData[forClient.<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html#acf0bf51dce3efe39b3c9635d26120ea0">EndpointId</a>.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>];</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            StreamPartInfo packetInfo;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">if</span> (clientData.SendPackets.TryGetValue(packetId, out packetInfo))</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <span class="keywordflow">if</span> (delivered)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    clientData.SendPackets.Remove(packetId);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                    <span class="keywordflow">if</span> (clientData.SendPackets.Count == 0 &amp;&amp; clientData.RemainingBits == 0)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        clientData.Dirty = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        clientData.ForceSend = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    <span class="keywordflow">if</span> (clientData.ObjectData != null)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        clientData.FailedIncompletePackets.Add(packetInfo);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        clientData.Dirty = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        clientData.SendPackets.Remove(packetId);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ab127931ee649ffc4bc6e7fbe2599d52a">  498</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ab127931ee649ffc4bc6e7fbe2599d52a">ForceSend</a>(<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html">MyClientStateBase</a> clientData)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            StreamClientData streamData = m_clientStreamData[clientData.<a class="code" href="class_v_rage_1_1_network_1_1_my_client_state_base.html#acf0bf51dce3efe39b3c9635d26120ea0">EndpointId</a>.<a class="code" href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">Value</a>];</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            streamData.ForceSend = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            SaveReplicable(streamData);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div>
<div class="ttc" id="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream_html"><div class="ttname"><a href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html">VRage.Library.Collections.BitStream</a></div><div class="ttdoc">Stream which writes data based on bits. When writing, buffer must be reset to zero to write values co...</div><div class="ttdef"><b>Definition:</b> <a href="_bit_stream_8cs_source.html#l00020">BitStream.cs:20</a></div></div>
<div class="ttc" id="namespace_system_1_1_text_html"><div class="ttname"><a href="namespace_system_1_1_text.html">System.Text</a></div><div class="ttdef"><b>Definition:</b> <a href="_sandbox_8_graphics_2_string_builder_extensions_8cs_source.html#l00008">StringBuilderExtensions.cs:8</a></div></div>
<div class="ttc" id="namespace_sandbox_1_1_game_html"><div class="ttname"><a href="namespace_sandbox_1_1_game.html">Sandbox.Game</a></div></div>
<div class="ttc" id="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils_html"><div class="ttname"><a href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html">VRage.Library.Utils.MyLibraryUtils</a></div><div class="ttdef"><b>Definition:</b> <a href="_my_library_utils_8cs_source.html#l00010">MyLibraryUtils.cs:10</a></div></div>
<div class="ttc" id="class_v_rage_1_1_utils_1_1_my_log_html"><div class="ttname"><a href="class_v_rage_1_1_utils_1_1_my_log.html">VRage.Utils.MyLog</a></div><div class="ttdef"><b>Definition:</b> <a href="_my_log_8cs_source.html#l00049">MyLog.cs:49</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html">Sandbox.Game.Replication.MyStreamingEntityStateGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00059">MyStreamingEntityStateGroup.cs:59</a></div></div>
<div class="ttc" id="namespace_system_1_1_linq_html"><div class="ttname"><a href="namespace_system_1_1_linq.html">System.Linq</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_network_html"><div class="ttname"><a href="namespace_v_rage_1_1_network.html">VRage.Network</a></div><div class="ttdef"><b>Definition:</b> <a href="_blocking_attribute_8cs_source.html#l00006">BlockingAttribute.cs:6</a></div></div>
<div class="ttc" id="namespace_system_1_1_collections_1_1_generic_html"><div class="ttname"><a href="namespace_system_1_1_collections_1_1_generic.html">System.Collections.Generic</a></div><div class="ttdef"><b>Definition:</b> <a href="_dictionary_extensions_8cs_source.html#l00007">DictionaryExtensions.cs:7</a></div></div>
<div class="ttc" id="namespace_sandbox_1_1_engine_html"><div class="ttname"><a href="namespace_sandbox_1_1_engine.html">Sandbox.Engine</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_a49f1433ce94a056a2462618d9df838be"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a49f1433ce94a056a2462618d9df838be">Sandbox.Game.Replication.MyStreamingEntityStateGroup.CreateClientData</a></div><div class="ttdeci">void CreateClientData(MyClientStateBase forClient)</div><div class="ttdoc">Called on server new clients starts replicating this group. </div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00115">MyStreamingEntityStateGroup.cs:115</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_game_html_ae840d3864e36153d6f5013c7a0403dcf"><div class="ttname"><a href="namespace_v_rage_1_1_game.html#ae840d3864e36153d6f5013c7a0403dcf">VRage.Game.Game</a></div><div class="ttdeci">Game</div><div class="ttdef"><b>Definition:</b> <a href="_game_relation_attribute_8cs_source.html#l00005">GameRelationAttribute.cs:5</a></div></div>
<div class="ttc" id="class_v_rage_1_1_network_1_1_my_client_state_base_html"><div class="ttname"><a href="class_v_rage_1_1_network_1_1_my_client_state_base.html">VRage.Network.MyClientStateBase</a></div><div class="ttdoc">Base class for game-defined client state. It&#39;s set of data required by server, sent from client...</div><div class="ttdef"><b>Definition:</b> <a href="_my_client_state_base_8cs_source.html#l00017">MyClientStateBase.cs:17</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_v_rage_1_1_network_1_1_my_client_state_base_html_acf0bf51dce3efe39b3c9635d26120ea0"><div class="ttname"><a href="class_v_rage_1_1_network_1_1_my_client_state_base.html#acf0bf51dce3efe39b3c9635d26120ea0">VRage.Network.MyClientStateBase.EndpointId</a></div><div class="ttdeci">EndpointId EndpointId</div><div class="ttdoc">Client endpoint, don&#39;t serialize it in Serialize() </div><div class="ttdef"><b>Definition:</b> <a href="_my_client_state_base_8cs_source.html#l00022">MyClientStateBase.cs:22</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_ab127931ee649ffc4bc6e7fbe2599d52a"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ab127931ee649ffc4bc6e7fbe2599d52a">Sandbox.Game.Replication.MyStreamingEntityStateGroup.ForceSend</a></div><div class="ttdeci">void ForceSend(MyClientStateBase clientData)</div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00498">MyStreamingEntityStateGroup.cs:498</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_a09b345568e8b77b1d39b905de4fd7ca6"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a09b345568e8b77b1d39b905de4fd7ca6">Sandbox.Game.Replication.MyStreamingEntityStateGroup.ClientUpdate</a></div><div class="ttdeci">void ClientUpdate(uint timestamp)</div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00138">MyStreamingEntityStateGroup.cs:138</a></div></div>
<div class="ttc" id="interface_v_rage_1_1_network_1_1_i_my_state_group_html"><div class="ttname"><a href="interface_v_rage_1_1_network_1_1_i_my_state_group.html">VRage.Network.IMyStateGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_my_state_group_8cs_source.html#l00006">IMyStateGroup.cs:6</a></div></div>
<div class="ttc" id="namespace_sandbox_1_1_game_1_1_gui_html_a85590df7a7e0f84aafc9c190d8b4699eaa603905470e2a5b8c13e96b579ef0dba"><div class="ttname"><a href="namespace_sandbox_1_1_game_1_1_gui.html#a85590df7a7e0f84aafc9c190d8b4699eaa603905470e2a5b8c13e96b579ef0dba">Sandbox.Game.Gui.Debug</a></div></div>
<div class="ttc" id="interface_v_rage_1_1_network_1_1_i_my_replicable_html"><div class="ttname"><a href="interface_v_rage_1_1_network_1_1_i_my_replicable.html">VRage.Network.IMyReplicable</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_my_replicable_8cs_source.html#l00010">IMyReplicable.cs:10</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_a92fa83cbfe1400a64a1da015ac81773a"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a92fa83cbfe1400a64a1da015ac81773a">Sandbox.Game.Replication.MyStreamingEntityStateGroup.OnAck</a></div><div class="ttdeci">void OnAck(MyClientStateBase forClient, byte packetId, bool delivered)</div><div class="ttdoc">Called for each packet id sent to client from this state group. When ACK received, called immediatelly. When several other packets received from client, but some were missing, called for each missing packet. </div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00468">MyStreamingEntityStateGroup.cs:468</a></div></div>
<div class="ttc" id="_my_gui_skin_definition_8cs_html_a81a223a02c34d82b47199f08308847f2"><div class="ttname"><a href="_my_gui_skin_definition_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a></div><div class="ttdeci">using System</div><div class="ttdef"><b>Definition:</b> <a href="_my_gui_skin_definition_8cs_source.html#l00001">MyGuiSkinDefinition.cs:1</a></div></div>
<div class="ttc" id="interface_v_rage_1_1_network_1_1_i_my_streamable_replicable_html"><div class="ttname"><a href="interface_v_rage_1_1_network_1_1_i_my_streamable_replicable.html">VRage.Network.IMyStreamableReplicable</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_my_streamable_replicable_8cs_source.html#l00009">IMyStreamableReplicable.cs:9</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_network_html_afd0c0e2c33a4c1987d62c47d4bd7ffa1"><div class="ttname"><a href="namespace_v_rage_1_1_network.html#afd0c0e2c33a4c1987d62c47d4bd7ffa1">VRage.Network.StateGroupEnum</a></div><div class="ttdeci">StateGroupEnum</div><div class="ttdoc">State groups, used to limit bandwidth by group. </div><div class="ttdef"><b>Definition:</b> <a href="_state_group_enum_8cs_source.html#l00011">StateGroupEnum.cs:11</a></div></div>
<div class="ttc" id="struct_v_rage_1_1_network_1_1_endpoint_id_html_aa9ca44f336122a3e3d657e29d29bafb8"><div class="ttname"><a href="struct_v_rage_1_1_network_1_1_endpoint_id.html#aa9ca44f336122a3e3d657e29d29bafb8">VRage.Network.EndpointId.Value</a></div><div class="ttdeci">ulong Value</div><div class="ttdef"><b>Definition:</b> <a href="_endpoint_id_8cs_source.html#l00015">EndpointId.cs:15</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_utils_html"><div class="ttname"><a href="namespace_v_rage_1_1_utils.html">VRage.Utils</a></div><div class="ttdef"><b>Definition:</b> <a href="_my5_bit_encoding_8cs_source.html#l00006">My5BitEncoding.cs:6</a></div></div>
<div class="ttc" id="struct_v_rage_1_1_network_1_1_endpoint_id_html"><div class="ttname"><a href="struct_v_rage_1_1_network_1_1_endpoint_id.html">VRage.Network.EndpointId</a></div><div class="ttdoc">Id of network endpoint, opaque struct, internal value should not be accessed outside VRage...</div><div class="ttdef"><b>Definition:</b> <a href="_endpoint_id_8cs_source.html#l00013">EndpointId.cs:13</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_a60abf1237a1d63f9eafc191ad1e0d90c"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a60abf1237a1d63f9eafc191ad1e0d90c">Sandbox.Game.Replication.MyStreamingEntityStateGroup.GetGroupPriority</a></div><div class="ttdeci">float GetGroupPriority(int frameCountWithoutSync, MyClientInfo forClient)</div><div class="ttdoc">Gets priority related to client. When priority is lower than zero, it means the object is not relevan...</div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00152">MyStreamingEntityStateGroup.cs:152</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_ada0e8bc2839ea6ff0ff873e0cea0d7a7"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ada0e8bc2839ea6ff0ff873e0cea0d7a7">Sandbox.Game.Replication.MyStreamingEntityStateGroup.Destroy</a></div><div class="ttdeci">void Destroy()</div><div class="ttdoc">Called when state group is being destroyed. </div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00143">MyStreamingEntityStateGroup.cs:143</a></div></div>
<div class="ttc" id="class_v_rage_1_1_utils_1_1_my_log_html_a280e0f68244c251cc79e8e6862340bf2"><div class="ttname"><a href="class_v_rage_1_1_utils_1_1_my_log.html#a280e0f68244c251cc79e8e6862340bf2">VRage.Utils.MyLog.WriteLine</a></div><div class="ttdeci">void WriteLine(string message, LoggingOptions option)</div><div class="ttdef"><b>Definition:</b> <a href="_my_log_8cs_source.html#l00347">MyLog.cs:347</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_library_1_1_collections_html"><div class="ttname"><a href="namespace_v_rage_1_1_library_1_1_collections.html">VRage.Library.Collections</a></div><div class="ttdef"><b>Definition:</b> <a href="_bit_reader_8cs_source.html#l00006">BitReader.cs:6</a></div></div>
<div class="ttc" id="struct_v_rage_1_1_network_1_1_my_client_info_html_a1d5f48a00a73aa03af2bb7e0ae84bf4b"><div class="ttname"><a href="struct_v_rage_1_1_network_1_1_my_client_info.html#a1d5f48a00a73aa03af2bb7e0ae84bf4b">VRage.Network.MyClientInfo.IsReplicableReady</a></div><div class="ttdeci">bool IsReplicableReady(IMyReplicable replicable)</div><div class="ttdef"><b>Definition:</b> <a href="_my_client_info_8cs_source.html#l00046">MyClientInfo.cs:46</a></div></div>
<div class="ttc" id="namespace_system_1_1_i_o_html"><div class="ttname"><a href="namespace_system_1_1_i_o.html">System.IO</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_o_exception_extensions_8cs_source.html#l00010">IOExceptionExtensions.cs:10</a></div></div>
<div class="ttc" id="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream_html_a7d6cf5a969d27c6c35c26867d3f85d6c"><div class="ttname"><a href="class_v_rage_1_1_library_1_1_collections_1_1_bit_stream.html#a7d6cf5a969d27c6c35c26867d3f85d6c">VRage.Library.Collections.BitStream.ResetWrite</a></div><div class="ttdeci">void ResetWrite()</div><div class="ttdoc">Resets stream for writing. Uses internal buffer for writing, it&#39;s available as DataPointer. </div><div class="ttdef"><b>Definition:</b> <a href="_bit_stream_8cs_source.html#l00205">BitStream.cs:205</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_library_1_1_utils_html"><div class="ttname"><a href="namespace_v_rage_1_1_library_1_1_utils.html">VRage.Library.Utils</a></div><div class="ttdef"><b>Definition:</b> <a href="_blittable_helper_8cs_source.html#l00008">BlittableHelper.cs:8</a></div></div>
<div class="ttc" id="namespace_math_html"><div class="ttname"><a href="namespace_math.html">Math</a></div></div>
<div class="ttc" id="namespace_buffer_html"><div class="ttname"><a href="namespace_buffer.html">Buffer</a></div></div>
<div class="ttc" id="class_v_rage_1_1_utils_1_1_my_log_html_ad6211c26fe6b341fedd7d8fe05eb14fd"><div class="ttname"><a href="class_v_rage_1_1_utils_1_1_my_log.html#ad6211c26fe6b341fedd7d8fe05eb14fd">VRage.Utils.MyLog.Default</a></div><div class="ttdeci">static MyLog Default</div><div class="ttdef"><b>Definition:</b> <a href="_my_log_8cs_source.html#l00121">MyLog.cs:121</a></div></div>
<div class="ttc" id="namespace_sandbox_1_1_game_1_1_entities_html"><div class="ttname"><a href="namespace_sandbox_1_1_game_1_1_entities.html">Sandbox.Game.Entities</a></div><div class="ttdef"><b>Definition:</b> <a href="_my_entity3_d_sound_emitter_8cs_source.html#l00018">MyEntity3DSoundEmitter.cs:18</a></div></div>
<div class="ttc" id="namespace_system_1_1_collections_html"><div class="ttname"><a href="namespace_system_1_1_collections.html">System.Collections</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_network_html_adac6df3dba000e71924ba5bd2286cd76a8c340dc334134096f68b880b42a8692c"><div class="ttname"><a href="namespace_v_rage_1_1_network.html#adac6df3dba000e71924ba5bd2286cd76a8c340dc334134096f68b880b42a8692c">VRage.Network.Replication</a></div></div>
<div class="ttc" id="namespace_sandbox_html"><div class="ttname"><a href="namespace_sandbox.html">Sandbox</a></div></div>
<div class="ttc" id="namespace_v_rage_html"><div class="ttname"><a href="namespace_v_rage.html">VRage</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_ad755c81fbc0fc1be185a40cdd6fc5381"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ad755c81fbc0fc1be185a40cdd6fc5381">Sandbox.Game.Replication.MyStreamingEntityStateGroup.DestroyClientData</a></div><div class="ttdeci">void DestroyClientData(MyClientStateBase forClient)</div><div class="ttdoc">Called on server when client stops replicating this group. </div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00130">MyStreamingEntityStateGroup.cs:130</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_a7e7f84a5b9a9de3476460bb9d00c1875"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#a7e7f84a5b9a9de3476460bb9d00c1875">Sandbox.Game.Replication.MyStreamingEntityStateGroup.Serialize</a></div><div class="ttdeci">bool Serialize(VRage.Library.Collections.BitStream stream, EndpointId forClient, uint timestamp, byte packetId, int maxBitPosition)</div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00429">MyStreamingEntityStateGroup.cs:429</a></div></div>
<div class="ttc" id="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group_html_ac4d4a13260701b3fb4ff2a55b780defb"><div class="ttname"><a href="class_sandbox_1_1_game_1_1_replication_1_1_my_streaming_entity_state_group.html#ac4d4a13260701b3fb4ff2a55b780defb">Sandbox.Game.Replication.MyStreamingEntityStateGroup.MyStreamingEntityStateGroup</a></div><div class="ttdeci">MyStreamingEntityStateGroup(T obj)</div><div class="ttdef"><b>Definition:</b> <a href="_my_streaming_entity_state_group_8cs_source.html#l00069">MyStreamingEntityStateGroup.cs:69</a></div></div>
<div class="ttc" id="struct_v_rage_1_1_network_1_1_my_client_info_html_a834351798d201ff41e34d2baf1e6fd6e"><div class="ttname"><a href="struct_v_rage_1_1_network_1_1_my_client_info.html#a834351798d201ff41e34d2baf1e6fd6e">VRage.Network.MyClientInfo.EndpointId</a></div><div class="ttdeci">EndpointId EndpointId</div><div class="ttdef"><b>Definition:</b> <a href="_my_client_info_8cs_source.html#l00014">MyClientInfo.cs:14</a></div></div>
<div class="ttc" id="struct_v_rage_1_1_network_1_1_my_client_info_html"><div class="ttname"><a href="struct_v_rage_1_1_network_1_1_my_client_info.html">VRage.Network.MyClientInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="_my_client_info_8cs_source.html#l00009">MyClientInfo.cs:9</a></div></div>
<div class="ttc" id="namespace_v_rage_1_1_library_html"><div class="ttname"><a href="namespace_v_rage_1_1_library.html">VRage.Library</a></div></div>
<div class="ttc" id="namespace_sandbox_1_1_engine_1_1_utils_html"><div class="ttname"><a href="namespace_sandbox_1_1_engine_1_1_utils.html">Sandbox.Engine.Utils</a></div><div class="ttdef"><b>Definition:</b> <a href="_my_battle_helper_8cs_source.html#l00014">MyBattleHelper.cs:14</a></div></div>
<div class="ttc" id="struct_v_rage_1_1_network_1_1_my_client_info_html_af11d3cae7ed4ffac984125b2aa2af8dd"><div class="ttname"><a href="struct_v_rage_1_1_network_1_1_my_client_info.html#af11d3cae7ed4ffac984125b2aa2af8dd">VRage.Network.MyClientInfo.HasReplicable</a></div><div class="ttdeci">bool HasReplicable(IMyReplicable replicable)</div><div class="ttdef"><b>Definition:</b> <a href="_my_client_info_8cs_source.html#l00041">MyClientInfo.cs:41</a></div></div>
<div class="ttc" id="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils_html_afd4d5ec658b60d4fded0e1018f543680"><div class="ttname"><a href="class_v_rage_1_1_library_1_1_utils_1_1_my_library_utils.html#afd4d5ec658b60d4fded0e1018f543680">VRage.Library.Utils.MyLibraryUtils.GetDivisionCeil</a></div><div class="ttdeci">static int GetDivisionCeil(int num, int div)</div><div class="ttdef"><b>Definition:</b> <a href="_my_library_utils_8cs_source.html#l00098">MyLibraryUtils.cs:98</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 23 2017 01:16:43 for Space Engineers by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
